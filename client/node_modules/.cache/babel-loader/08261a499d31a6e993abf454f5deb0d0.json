{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar OperationType_1 = require(\"../OperationType\");\n\nvar Utils_1 = require(\"../Utils\");\n\nvar DefaultSubscriptionAdapter =\n/** @class */\nfunction () {\n  function DefaultSubscriptionAdapter(options) {\n    if (Array.isArray(options)) {\n      this.variables = Utils_1.default.resolveVariables(options);\n    } else {\n      this.variables = options.variables;\n      this.fields = options.fields;\n      this.operation = options.operation;\n    }\n  }\n\n  DefaultSubscriptionAdapter.prototype.subscriptionBuilder = function () {\n    return this.operationWrapperTemplate(OperationType_1.default.Subscription, this.variables, this.operationTemplate(this.operation));\n  };\n\n  DefaultSubscriptionAdapter.prototype.subscriptionsBuilder = function (subscriptions) {\n    var _this = this;\n\n    var content = subscriptions.map(function (opts) {\n      _this.operation = opts.operation;\n      _this.variables = opts.variables;\n      _this.fields = opts.fields;\n      return _this.operationTemplate(opts.operation);\n    });\n    return this.operationWrapperTemplate(OperationType_1.default.Subscription, Utils_1.default.resolveVariables(subscriptions), content.join(\"\\n  \"));\n  }; // Convert object to name and argument map. eg: (id: $id)\n\n\n  DefaultSubscriptionAdapter.prototype.queryDataNameAndArgumentMap = function () {\n    return this.variables && Object.keys(this.variables).length ? \"(\" + Object.keys(this.variables).reduce(function (dataString, key, i) {\n      return \"\" + dataString + (i !== 0 ? \", \" : \"\") + key + \": $\" + key;\n    }, \"\") + \")\" : \"\";\n  };\n\n  DefaultSubscriptionAdapter.prototype.queryDataArgumentAndTypeMap = function (variables) {\n    return Object.keys(variables).length ? \"(\" + Object.keys(variables).reduce(function (dataString, key, i) {\n      return \"\" + dataString + (i !== 0 ? \", \" : \"\") + \"$\" + key + \": \" + Utils_1.default.queryDataType(variables[key]);\n    }, \"\") + \")\" : \"\";\n  }; // start of subscription building\n\n\n  DefaultSubscriptionAdapter.prototype.operationWrapperTemplate = function (type, variables, content) {\n    return {\n      query: type + \" \" + this.queryDataArgumentAndTypeMap(variables) + \" {\\n  \" + content + \"\\n}\",\n      variables: Utils_1.default.queryVariablesMap(variables)\n    };\n  };\n\n  DefaultSubscriptionAdapter.prototype.operationTemplate = function (operation) {\n    return operation + \" \" + this.queryDataNameAndArgumentMap() + \" {\\n    \" + this.queryFieldsMap(this.fields) + \"\\n  }\";\n  }; // Fields selection map. eg: { id, name }\n\n\n  DefaultSubscriptionAdapter.prototype.queryFieldsMap = function (fields) {\n    var _this = this;\n\n    return fields ? fields.map(function (field) {\n      return typeof field === \"object\" ? Object.keys(field)[0] + \" { \" + _this.queryFieldsMap(Object.values(field)[0]) + \" }\" : \"\" + field;\n    }).join(\", \") : \"\";\n  };\n\n  return DefaultSubscriptionAdapter;\n}();\n\nexports.default = DefaultSubscriptionAdapter;","map":{"version":3,"sources":["../../src/adapters/DefaultSubscriptionAdapter.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar OperationType_1 = require(\"../OperationType\");\nvar Utils_1 = require(\"../Utils\");\nvar DefaultSubscriptionAdapter = /** @class */ (function () {\n    function DefaultSubscriptionAdapter(options) {\n        if (Array.isArray(options)) {\n            this.variables = Utils_1.default.resolveVariables(options);\n        }\n        else {\n            this.variables = options.variables;\n            this.fields = options.fields;\n            this.operation = options.operation;\n        }\n    }\n    DefaultSubscriptionAdapter.prototype.subscriptionBuilder = function () {\n        return this.operationWrapperTemplate(OperationType_1.default.Subscription, this.variables, this.operationTemplate(this.operation));\n    };\n    DefaultSubscriptionAdapter.prototype.subscriptionsBuilder = function (subscriptions) {\n        var _this = this;\n        var content = subscriptions.map(function (opts) {\n            _this.operation = opts.operation;\n            _this.variables = opts.variables;\n            _this.fields = opts.fields;\n            return _this.operationTemplate(opts.operation);\n        });\n        return this.operationWrapperTemplate(OperationType_1.default.Subscription, Utils_1.default.resolveVariables(subscriptions), content.join(\"\\n  \"));\n    };\n    // Convert object to name and argument map. eg: (id: $id)\n    DefaultSubscriptionAdapter.prototype.queryDataNameAndArgumentMap = function () {\n        return this.variables && Object.keys(this.variables).length\n            ? \"(\" + Object.keys(this.variables).reduce(function (dataString, key, i) {\n                return \"\" + dataString + (i !== 0 ? \", \" : \"\") + key + \": $\" + key;\n            }, \"\") + \")\"\n            : \"\";\n    };\n    DefaultSubscriptionAdapter.prototype.queryDataArgumentAndTypeMap = function (variables) {\n        return Object.keys(variables).length\n            ? \"(\" + Object.keys(variables).reduce(function (dataString, key, i) {\n                return \"\" + dataString + (i !== 0 ? \", \" : \"\") + \"$\" + key + \": \" + Utils_1.default.queryDataType(variables[key]);\n            }, \"\") + \")\"\n            : \"\";\n    };\n    // start of subscription building\n    DefaultSubscriptionAdapter.prototype.operationWrapperTemplate = function (type, variables, content) {\n        return {\n            query: type + \" \" + this.queryDataArgumentAndTypeMap(variables) + \" {\\n  \" + content + \"\\n}\",\n            variables: Utils_1.default.queryVariablesMap(variables),\n        };\n    };\n    DefaultSubscriptionAdapter.prototype.operationTemplate = function (operation) {\n        return operation + \" \" + this.queryDataNameAndArgumentMap() + \" {\\n    \" + this.queryFieldsMap(this.fields) + \"\\n  }\";\n    };\n    // Fields selection map. eg: { id, name }\n    DefaultSubscriptionAdapter.prototype.queryFieldsMap = function (fields) {\n        var _this = this;\n        return fields\n            ? fields\n                .map(function (field) {\n                return typeof field === \"object\"\n                    ? Object.keys(field)[0] + \" { \" + _this.queryFieldsMap(Object.values(field)[0]) + \" }\"\n                    : \"\" + field;\n            })\n                .join(\", \")\n            : \"\";\n    };\n    return DefaultSubscriptionAdapter;\n}());\nexports.default = DefaultSubscriptionAdapter;\n//# sourceMappingURL=DefaultSubscriptionAdapter.js.map"]},"metadata":{},"sourceType":"script"}